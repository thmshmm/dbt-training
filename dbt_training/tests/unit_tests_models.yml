unit_tests:
  - name: customers_basic_unit_test
    model: customers
    description: |
      Unit test for the customers model. Checks correct aggregation and joins for a single customer with one order and one payment.
    given:
      - input: ref('stg_customers')
        rows:
          - {customer_id: 1, first_name: 'Alice', last_name: 'Smith'}
      - input: ref('stg_orders')
        rows:
          - {order_id: 100, customer_id: 1, order_date: '2024-01-01'}
      - input: ref('stg_payments')
        rows:
          - {payment_id: 200, order_id: 100, amount: 50.00}
    expect:
      rows:
        - {customer_id: 1, first_name: 'Alice', last_name: 'Smith', first_order: '2024-01-01', most_recent_order: '2024-01-01', number_of_orders: 1, customer_lifetime_value: 50.00}
